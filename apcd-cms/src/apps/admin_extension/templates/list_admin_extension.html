{% extends "apcd_cms/templates/standard.html" %}
{% load static %}
{% block content %}

<link rel="stylesheet" href="{% static 'apcd-cms/css/table.css' %}">
<link rel="stylesheet" href="{% static 'apcd-cms/css/modal.css' %}">
<link rel="stylesheet" href="{% static 'admin_extension/css/table.css' %}">

<div class="container">
  {% include "nav_cms_breadcrumbs.html" %}
  <div id="admin-extensions-root"></div>
</div>
<script>
  
  function filterTableByStatus() {
        var statusDropdown, statusValue, url_params, url, xhr;
        statusDropdown = document.getElementById("statusFilter");
        statusValue =  statusDropdown.value;
        url_params = `?status=${statusValue}`;
        {% if selected_org %}
            url_params = `?status=${statusValue}&org={{selected_org}}`;
        {% endif %}
        url = `/administration/list-extensions/${url_params}`;
        xhr = new XMLHttpRequest();
        xhr.open('GET', url);
        xhr.send();
        window.location.href = url;
        window.location.load();
    }
    function sortByOrg() {
        var orgDropdown, orgValue, url_params, url, xhr;
        orgDropdown = document.getElementById('organizationFilter');
        orgValue =  orgDropdown.value;
        url_params = `?org=${orgValue}`;
        {% if selected_status %}
            url_params = `?status={{selected_status}}&org=${orgValue}`;
        {% endif %}
        url = `/administration/list-extensions/${url_params}`;
        xhr = new XMLHttpRequest();
        xhr.open('GET', url);
        xhr.send();
        window.location.href = url;
        window.location.load();
    }
    function clearSelections() {
        var xhr;
        xhr = new XMLHttpRequest();
        xhr.open('GET', '/administration/list-extensions/')
        xhr.send()
        window.location.href = '/administration/list-extensions/';
        window.location.load();
    }
    function openAction(extension_id) {
    var actionsDropdown, selectedOption, modal_id;
    actionsDropdown = document.getElementById(`actionsDropdown_${extension_id}`);
    /* grabs dropdown option number selected by user via selectedIndex, 
      then grabs actual value associated with that option via 
      options[index].value */
    selectedOption = actionsDropdown.options[actionsDropdown.selectedIndex].value;
    modal_id = `${selectedOption}Modal_${extension_id}`;
    $(`#${modal_id}`).modal({backdrop: "static"}); /* modal appears manually */
  
    actionsDropdown.selectedIndex = 0; /* resets dropdown to display 'Select Action' again */
  }
</script>
{% endblock %}